
<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Testing Super Mario Using a Behavior Model Autonomously (Part 2) | TestFlows</title>
  <meta name="description" content="An article about autonomous testing of Super Mario using behavior models and evolutionary state space exploration techniques.">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Vitaliy Zakaznikov">
  <meta name="og:site_name" content="TestFlows">
  <meta property="og:image" content="https://testflows.com/images/testing-super-mario-using-a-behavior-model-autonomously-part2.png">
  
  <link rel="preload" as="image" href="https://testflows.com/img/logo.png">
  
  
  <meta name="image" property="og:image" content="https://testflows.com/">
<meta name="publish_date" property="og:publish_date" content="2025-10-10T00:00:00-0000">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2025-10-10T00:00:00-0000" />
<meta property="og:title" content="Testing Super Mario Using a Behavior Model Autonomously (Part 2)">
<meta property="og:image" content="https://testflows.com/">
<meta property="og:description" content="An article about autonomous testing of Super Mario using behavior models and evolutionary state space exploration techniques.">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Testing Super Mario Using a Behavior Model Autonomously (Part 2)">
<meta name="twitter:description" content="An article about autonomous testing of Super Mario using behavior models and evolutionary state space exploration techniques.">
<meta name="twitter:image" content="https://testflows.com/">
  
  
  <link href="https://testflows.com/img/favicon.ico" rel="icon">
  
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/bootstrap/bootstrap.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css?v=1764192764755" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/fontawesome/css/all.css?v=1.0" type="text/css">
  <link rel="stylesheet" href="/css/style.css?v=1764192764755" media="screen" type="text/css">
  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-sham.min.js"></script>
  <![endif]-->
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <nav id="main-nav" class="fixed-top navbar navbar-expand-md navbar-fixed-top" role="navigation">
    <a class="navbar-brand" href="/">
        <img src="/img/logo-white.png" alt="TestFlows">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon fas fa-2x fa-bars"></span>
    </button>
    <div class="collapse navbar-collapse nav-menu" id="navbarNav">
        <ul class="nav navbar-nav">
            
                <li class="nav-item">
                    <a class="nav-link" href="/handbook"><i class="fas fa-book pr-2"></i>Handbook</a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link" href="/blog"><i class="fas fa-blog pr-2"></i>Blog</a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link" href="/about.html"><i class="fas fa-info-circle pr-2"></i>About</a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link" href="/contact.html"><i class="fas fa-envelope-open-text pr-2"></i>Contact</a>
                </li>
            
        </ul>
    </div>
</nav>
<div class="clearfix"></div>

  <div class="container-fluid p-0">
    <div class="content">
      <div class="container" style="padding-bottom: 2em !important">
    <div class="post-header row">
        <div class="post-summary col-lg-6 mt-auto mb-auto">
            <h1 style="font-weight: bold;">Testing Super Mario Using a Behavior Model Autonomously (Part 2)</h1>
            <div class="post-metadata">
                <div class="post-author">
                    <span class="author-title text-nowrap">Written By</span><span class="author-name">Vitaliy Zakaznikov</span>
                    <time datetime="2025-10-10T00:00:00-0000"><span class="authored-date text-nowrap">Oct 10, 2025</span></time>
                </div>
                <div class="post-share btn-group" role="group" aria-label="share">
                    <span class="caption">Share It</span>
                    <a target="_blank" rel="noopener external nofollow noreferrer" href="https://twitter.com/intent/tweet?url=https://testflows.com/blog/testing-super-mario-using-a-behavior-model-autonomously-part2/">
                        <i class="fab fa-2x fa-twitter"></i>
                    </a>
                    <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.facebook.com/sharer/sharer.php?u=https://testflows.com/blog/testing-super-mario-using-a-behavior-model-autonomously-part2/">
                        <i class="fab fa-2x fa-facebook"></i>
                    </a>
                    <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.linkedin.com/shareArticle?mini=true&url=https://testflows.com/blog/testing-super-mario-using-a-behavior-model-autonomously-part2/">
                        <i class="fab fa-2x fa-linkedin"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="post-image col-lg-6 m-auto">
            <img src="/images/testing-super-mario-using-a-behavior-model-autonomously-part2.png"></img>
            <span class="post-image-credit"></span>
        </div>
    </div>
    <div class="blog post-body row">
        <div class="col-12">
            <p>In <a href="/blog/testing-super-mario-using-a-behavior-model-autonomously-part1/">Part 1</a>, we built an autonomous system that beat all four levels of <em>Super Mario Bros.</em> without any human guidance. We treated the exploration as a mutation-based Genetic Algorithm, and it worked: the system discovered winning paths by exploring, replaying, and mutating input sequences. It found shortcuts, navigated complex enemy patterns, and even uncovered unexpected behaviors like <a href="/blog/testing-super-mario-using-a-behavior-model-autonomously-part1/#Finding-a-path-to-complete-Level-4">the Level 4 collision bug</a>. However, the exploration only validated one dimension of correctness: <em>Mario’s progress</em>. Our fitness function measured how far Mario advanced (x-position, level completion, and time), but the exploration couldn’t tell us whether the game actually behaved correctly. Did Mario’s velocity follow expected constraints? Were jumps causally justified? Did falling only occur when Mario lacked ground support? We had no way to know. This shows that autonomous testing by itself is not enough. To address this problem, we need a way to actually check state correctness. What we need is to plug in a behavior model!<span id="more"></span></p>
<h2 id="Plugging-the-Behavior-Model"><a href="#Plugging-the-Behavior-Model" class="headerlink" title="Plugging the Behavior Model"></a>Plugging the Behavior Model</h2><p>We already had a behavior model from our earlier series (<a href="/blog/testing-super-mario-using-a-behavior-model-part1/">Part 1</a> and <a href="/blog/testing-super-mario-using-a-behavior-model-part2/">Part 2</a>)—a model with <strong>causal</strong>, <strong>safety</strong>, and <strong>liveness</strong> properties that enforce game correctness frame-by-frame. The original model is available in the v2.0 branch:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --branch v2.0 --single-branch https://github.com/testflows/Examples.git &amp;&amp; <span class="built_in">cd</span> Examples/SuperMario</span><br></pre></td></tr></table></figure>

<p>This <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v2.0/SuperMario/tests/models/game.py#L7">model</a> is by no means complete and is limited to enforcing that <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v2.0/SuperMario/tests/models/mario/movement.py#L475">Mario’s movement</a> has a valid cause, that velocity never exceeds physical limits, that boundaries are respected, and that expected behaviors eventually occur. However, given that the model is composable, we will add two additional properties later.</p>
<p>The integration is simple. We pass the model to the same <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v2.0/SuperMario/tests/autonomous_play.py#L71">play()</a> function that advances the game. Every frame, the <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v2.0/SuperMario/tests/actions/game.py#L267">play()</a> method calls the model’s <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v2.0/SuperMario/tests/actions/game.py#L275">expect()</a> method, which runs all the property checks. Here’s the implementation:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">play</span>(<span class="params">game, seconds=<span class="number">1</span>, frames=<span class="literal">None</span>, model=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Play the game for the specified number of seconds or frames.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> frames <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        frames = <span class="built_in">int</span>(seconds * game.fps)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(frames):</span><br><span class="line">        <span class="built_in">next</span>(game.play)</span><br><span class="line">        <span class="keyword">if</span> model:</span><br><span class="line">            model.expect(game.behavior) <span class="comment"># here we call the model</span></span><br></pre></td></tr></table></figure>

<h2 id="Running-autonomous-exploration-with-the-model"><a href="#Running-autonomous-exploration-with-the-model" class="headerlink" title="Running autonomous exploration with the model"></a>Running autonomous exploration with the model</h2><p>Now let’s see what happens when we run autonomous exploration with the model enabled:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 tests/run.py --autonomous --play-seconds 300 --fps 300 --with-model</span><br></pre></td></tr></table></figure>

<div class="text-center">
<video width="50%" controls>
  <source src="/images/testing-super-mario-using-a-behavior-model-autonomously-video6.webm" type="video/webm">
  Your browser does not support the video tag.
</video>
<div class="text-secondary text-bold"><br>Autonomous exploration with behavior model</div>
</div><br>

<p>The system explores thousands of states, validating every frame. Properties pass, pass, pass… until they don’t. Here’s what a failure from the video above looks like:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">40s 432ms         ⟥    [debug] ✓ Mario Mario<span class="string">&#x27;s vertical velocity 0 is less than the maximum</span></span><br><span class="line"><span class="string">40s 432ms         ⟥    [debug] ✓ Mario Mario is within left boundary x=1014, boundary=0</span></span><br><span class="line"><span class="string">40s 432ms         ⟥    [debug] ✓ Mario Mario is within right boundary x=1014, boundary=9046</span></span><br><span class="line"><span class="string">40s 439ms         ⟥    [debug] ✓ Mario stayed in place (0)</span></span><br><span class="line"><span class="string">40s 440ms         ⟥    Exception: AssertionError: Mario failed to: fell 25 because there was no ground support</span></span><br></pre></td></tr></table></figure>

<p>The model caught something. But here’s the catch: this failure could mean the game has a bug, or it could mean our model is wrong. We need to figure out which one.</p>
<h2 id="Bidirectional-testing"><a href="#Bidirectional-testing" class="headerlink" title="Bidirectional testing"></a>Bidirectional testing</h2><p>When the model’s assertion fails, we face a fundamental question: <em>Is the game wrong, or is the model wrong?</em></p>
<p>This is where bidirectional testing comes in. Unlike traditional testing where only the system is validated, for any non-trivial properties or transition relations, both the model and the game test each other simultaneously:</p>
<ul>
<li><p><strong>The model tests the game</strong>: Every frame, the model enforces that the game’s behavior satisfies the specified properties. If Mario moves right, there must be a cause (velocity or key press). If Mario falls, he must lack ground support. These are the model’s expectations.</p>
</li>
<li><p><strong>The game tests the model</strong>: The game acts as the ground truth—it’s what actually runs and what players experience. When the model’s expectations fail, it reveals that the model’s understanding might be incomplete or incorrect.</p>
</li>
</ul>
<p>This creates a self-correcting feedback loop:</p>
<div class="text-center">
<img style="width: 55%" src="/images/testing-super-mario-using-a-behavior-model-autonomously-pic-3.png">
<div class="text-secondary text-bold"><br>Bidirectional testing</div>
</div>

<ol>
<li>If the game violates physics → game bug (model is correct)</li>
<li>If the model’s expectations are wrong → model bug (game is correct)</li>
</ol>
<p>Both components improve through their disagreements. Fix a game bug, and the model becomes more reliable. Fix a model bug, and game validation becomes more accurate. Each fix makes the other component more trustworthy. </p>
<h2 id="Deciding-if-model-or-game-has-a-bug"><a href="#Deciding-if-model-or-game-has-a-bug" class="headerlink" title="Deciding if model or game has a bug"></a>Deciding if model or game has a bug</h2><p>So how do we figure out which component has the bug? This is the classic test <a target="_blank" rel="noopener external nofollow noreferrer" href="https://en.wikipedia.org/wiki/Test_oracle">oracle problem</a>—how do you know what the correct behavior should be?</p>
<p>The theoretical answer is sobering: deciding if a non-trivial model matches software is undecidable in general. For Turing-complete systems, there’s no algorithm that can always decide if the model and software agree for all possible inputs. Even for finite-state systems, you’d need to explore the entire state space, which is computationally infeasible for complex systems like our Mario game.</p>
<p>But here’s the practical insight: autonomous testing is just as good at finding when the model’s expectations don’t match the game as it is at finding when the game doesn’t match the model. We can’t prove the model is correct in absolute terms, but autonomous testing excels at finding disagreements. When a failure occurs, we just use a pragmatic approach:</p>
<ol>
<li><strong>Analyze the failure</strong>: When a property fails, examine the saved path to understand what happened.</li>
<li><strong>Determine the cause</strong>: Is the game violating a physical law? Or is the model missing context about a valid game mechanic?</li>
<li><strong>Fix what’s wrong</strong>: Update either the game or the model based on the analysis.</li>
<li><strong>Re-run and validate</strong>: The bidirectional loop continues—both components get refined.</li>
</ol>
<h2 id="Deterministic-execution"><a href="#Deterministic-execution" class="headerlink" title="Deterministic execution"></a>Deterministic execution</h2><p>The game’s execution is fully deterministic, so the same sequence of inputs always produces the same state. This makes failure analysis much simpler. We record the full path that led to the model’s disagreement with the game’s behavior, and we can replay it exactly.</p>
<p>The value of deterministic execution can’t be overstated. Debugging weird corner cases found by autonomous exploration is already hard, but non-determinism and lack of reproducibility add significant complexity. With deterministic execution, we can replay the path as many times as we want and always hit the same failure. This makes failure analysis straightforward.</p>
<p>Deterministic execution also makes validating fixes much easier. When we fix the model, it doesn’t affect the game’s deterministic behavior, so we can verify the fix by replaying the failed path. Fixes to the game itself are a little bit trickier. We get the same benefit of re-running and validating the fix using the same failed path—as long as the game fix didn’t change the path behavior up to the point of failure. If the game’s behavior changed before that point, the failed path doesn’t lead to the same state, making the fix harder to verify.</p>
<p>The ability to save a failed path to a file was added in the <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/tests/autonomous_play.py#L93">v3.0</a> branch, which we’ll checkout and use it to see this process in action.</p>
<h2 id="Updating-the-model"><a href="#Updating-the-model" class="headerlink" title="Updating the model"></a>Updating the model</h2><p>When we first ran autonomous exploration with the v2.0 model, failures started piling up. But here’s the thing: many of these failures weren’t game bugs—they were model bugs. The model’s expectations didn’t match the game’s actual behavior.</p>
<p>Most failures came from horizontal or vertical position adjustments. The game engine adjusts Mario’s position when he collides with bricks, shells, boundaries, and other objects. These adjustments are normal game behavior, but the v2.0 model didn’t account for them.</p>
<p>Let’s look at the original <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v2.0/SuperMario/tests/models/mario/movement.py#L266"><code>check_right_movement</code></a> causal property:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">check_right_movement</span>(<span class="params">self, behavior</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Check if Mario&#x27;s right movement had a valid cause.&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    actual_movement = behavior.actual_movement</span><br><span class="line">    velocity = behavior.velocity</span><br><span class="line">    right_pressed = self.right_pressed(behavior.keys)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> self.moved_right(actual_movement):</span><br><span class="line">        self.model.assert_with_success(</span><br><span class="line">            self.has_right_movement_cause(velocity, right_pressed),</span><br><span class="line">            <span class="string">f&quot;moved right because <span class="subst">&#123;<span class="string">f&#x27;velocity is <span class="subst">&#123;velocity&#125;</span>&#x27;</span> <span class="keyword">if</span> velocity &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;right key is pressed&#x27;</span>&#125;</span>&quot;</span>,</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<p>The <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v2.0/SuperMario/tests/models/mario/movement.py#L202"><code>moved_right()</code></a> method returns true if actual movement is greater than 1 pixel (this also turned out to be a bug: we actually needed <code>&gt;= 1</code>). When that happens, we assert that right movement has a valid cause by calling <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v2.0/SuperMario/tests/models/mario/movement.py#L190"><code>has_right_movement_cause</code></a>, which returns true if the player has positive velocity or the right key was pressed.</p>
<p>This logic works in many game states, but it fails when Mario gets snapped by a collision. The game calls <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v2.0/SuperMario/source/states/level.py#L387"><code>adjust_player_for_x_collisions()</code></a> and <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v2.0/SuperMario/source/states/level.py#L462"><code>adjust_player_for_y_collisions()</code></a> in various code paths, causing position jumps that don’t reflect actual velocity. These adjustments can happen in the current frame or persist from the previous frame.</p>
<p>The fix was conceptually simple: skip the check when there’s a collision adjustment. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> self.moved_right(actual_movement):</span><br><span class="line">    <span class="comment"># Skip check if there&#x27;s a collision causing position adjustment</span></span><br><span class="line">    <span class="comment"># Position adjustments can cause large position jumps that don&#x27;t reflect actual velocity</span></span><br><span class="line">    <span class="keyword">if</span> behavior.has_horizontal_collision_adjustment <span class="keyword">or</span> behavior.had_horizontal_collision_adjustment:</span><br><span class="line">        debug(</span><br><span class="line">            <span class="string">&quot;Collision adjustment is expected, skipping right movement cause check&quot;</span></span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">return</span></span><br></pre></td></tr></table></figure>

<p>But here’s the problem: implementing <code>has_horizontal_collision_adjustment</code> and <code>had_horizontal_collision_adjustment</code> turned out to be quite complex! A full reimplementation of that logic would blow up the model.</p>
<p>We needed ground truth from the game itself: direct information from the game engine about what actually happened, not our best guess. This meant expanding the game’s observability to expose collision information, viewport state, and other details the model needed. Given the fixes were needed in both the model and the game code, we created a <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/tree/v3.0">v3.0</a> branch to implement them. We also added two new safety properties: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/tests/models/mario/movement.py#L683"><code>check_does_not_overlap_with_solid_objects</code></a> to ensure Mario never overlaps solid objects, and <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/tests/models/mario/movement.py#L667"><code>check_does_not_exceed_max_position_adjustment</code></a> to enforce that per-frame displacement stays within physical limits.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># If you already have v2.0 checked out, switch to v3.0</span></span><br><span class="line">git fetch origin v3.0 &amp;&amp; git checkout v3.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Or if starting fresh, clone v3.0 directly</span></span><br><span class="line">git <span class="built_in">clone</span> --branch v3.0 --single-branch https://github.com/testflows/Examples.git &amp;&amp; <span class="built_in">cd</span> Examples/SuperMario</span><br></pre></td></tr></table></figure>

<h2 id="Expanding-game’s-observability"><a href="#Expanding-game’s-observability" class="headerlink" title="Expanding game’s observability"></a>Expanding game’s observability</h2><p>To give the model ground truth, we added observability directly to the game engine. The key addition is the <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/source/components/player.py#L10"><code>CollisionInfo</code></a> class that tracks when the engine adjusts Mario’s position due to collisions. The <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/source/components/player.py#L27"><code>Player</code></a> class now has a <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/source/components/player.py#L47"><code>collision_info</code></a> attribute with <code>x_adjusted</code> and <code>y_adjusted</code> flags that get reset each frame and set whenever the engine snaps Mario’s position. This information flows into <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/tests/actions/game.py#L112"><code>BehaviorState</code></a> so the model can access it directly.</p>
<p>We also added viewport tracking so the model can verify Mario stays on screen, and improved key state extraction to handle edge cases like simultaneous key presses. The model now has direct access to what the engine actually did, not what we tried to infer from deltas.</p>
<p>For complex behavior systems, instrumentation like this is absolutely necessary. Without it, the model would have to reimplement complex game logic just to detect when certain events occurred, which would blow up the model’s complexity and make it fragile. By instrumenting the game engine, we keep the model simple and focused on validating behavior rather than reverse-engineering internal state.</p>
<h2 id="Finding-and-fixing-more-bugs-in-the-model"><a href="#Finding-and-fixing-more-bugs-in-the-model" class="headerlink" title="Finding and fixing more bugs in the model"></a>Finding and fixing more bugs in the model</h2><p>Once we added and exposed collision adjustments, the <code>check_right_movement</code> and other checks became much more stable. It turned out that most of our checks needed to account for these adjustments.</p>
<p>Further runs, however, revealed more issues. For example, we had to update the model to use <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/tests/models/mario/movement.py#L56"><code>centerx</code></a> for horizontal positions and <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/tests/models/mario/movement.py#L74"><code>rect.bottom</code></a> for vertical positions instead of <code>rect.x</code> and <code>rect.y</code>, which change when sprite animations change size. This ensured that all velocity calculations were not affected by sprite animation changes, especially when Mario was in the big state after collecting a mushroom.</p>
<p>We also extended the history window from 3 frames to <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/tests/models/mario/movement.py#L19">4 frames</a> (<code>right_right_before</code>, <code>right_before</code>, <code>before</code>, <code>now</code>) to better track multi-frame collision interactions, such as brick bumps that persist across multiple frames.</p>
<p>These changes fixed the model’s false positives. Collision snaps, brick bumps, shell kicks—all the edge cases that broke the v2.0 model—now worked correctly. However, finding and fixing bugs did not stop there, because once the model was updated and became much more stable, we were tempted to add a few more properties and started finding real game bugs.</p>
<h2 id="Finding-and-fixing-bugs-in-the-game"><a href="#Finding-and-fixing-bugs-in-the-game" class="headerlink" title="Finding and fixing bugs in the game"></a>Finding and fixing bugs in the game</h2><p>The first bug we found was an instrumentation issue. The game was resetting <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/source/components/player.py#L47"><code>collision_info</code></a> before the recorder snapshot, so <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/source/components/player.py#L17"><code>x_adjusted</code></a> and <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/source/components/player.py#L18"><code>y_adjusted</code></a> flags read false even after teleport snaps. We fixed this by moving the reset into <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/source/components/player.py#L151"><code>Player.update</code></a> and propagating the flags through <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/tests/actions/game.py#L112"><code>BehaviorState</code></a>.</p>
<p>After that, we started to find real engine bugs. First, stacked brick collisions were snapping Mario to the wrong height because <code>spritecollideany</code> grabbed the first overlapping brick. We fixed this with a new <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/source/states/level.py#L477"><code>get_vertical_collision</code></a> method that collects all overlaps and chooses the correct ceiling or floor. We also found that gravity wasn’t being reinitialized after head bumps, causing anomalous velocity deltas. Additionally, we found issues with Mario disappearing. It turned out that the viewport could drift after position adjustments because the camera only advanced when velocity was nonzero.</p>
<p>But the most interesting bug was the Level 4 teleport. Autonomous exploration found a path where Mario would suddenly teleport across the screen near the firebar section. The model’s “Mario does not overlap any solid objects” property failed, but replaying the path showed something strange: Mario would brush against the firebar pedestal and then instantly appear far away.</p>
<p>Here is a video of the gameplay that we created using a saved failed path.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 tests/run.py --autonomous --fps 300 --start-level 4 --load-paths --paths-file fails/4-1.json --play-best-path --save-video</span><br></pre></td></tr></table></figure>

<div class="text-center">
<video width="50%" controls>
  <source src="/images/testing-super-mario-using-a-behavior-model-autonomously-video5.webm" type="video/webm">
  Your browser does not support the video tag.
</video>
<div class="text-secondary text-bold"><br>Level 4 teleport bug</div>
</div><br>

<p>Note how Mario teleports when hitting one of the firebar boxes!</p>
<p>Running the same failed path with the model enabled shows how our model detected this issue.</p>
<blockquote>
<p>By the way, this is also a demonstration of how deterministic execution makes our lives easier!</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 tests/run.py --autonomous --with-model --fps 300 --start-level 4 --load-paths --paths-file fails/4-1.json --play-best-path --save-video</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">11s 858ms         ⟥    [debug] ✓ Mario Mario<span class="string">&#x27;s horizontal move 6px is within max limits</span></span><br><span class="line"><span class="string">11s 858ms         ⟥    [debug] ✓ Mario Mario&#x27;</span>s vertical move 40px is within max limits</span><br><span class="line">11s 858ms         ⟥    [debug] ✓ Mario Mario is within left boundary x=3551, boundary=0</span><br><span class="line">11s 858ms         ⟥    [debug] ✓ Mario Mario is within right boundary x=3551, boundary=6814</span><br><span class="line">11s 858ms         ⟥    [note] Model assertion failed: Mario failed to: Mario does not overlap any solid objects</span><br></pre></td></tr></table></figure>

<p>After analyzing the saved path, we discovered the root cause: two <code>step</code> colliders at <code>x≈3580</code> overlapped by just 1 pixel. When Mario touched the firebar pedestal, the X collision resolver snapped him to the first collider, but he still overlapped the second collider. The Y resolver then interpreted this as a head bump and pushed Mario downward into the floor slab. On the next frame, the X resolver ejected him to the far edge of the slab, creating the apparent teleport.</p>
<p>Because this was a level layout bug, not an engine bug, we fixed it by removing the duplicate collider from the <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows/Examples/blob/v3.0/SuperMario/source/data/maps/level_4.json">level map data</a> and adding a 1-pixel offset guard to prevent future overlaps.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>We started with autonomous exploration that could beat all four levels, but it only validated progress—not correctness. By integrating a behavior model, we transformed exploration into a correctness validation system that checked every frame.</p>
<p>The journey revealed the power of bidirectional testing: the model found game bugs, and the game revealed model bugs. This self-correcting feedback loop improved both components. We expanded the game’s observability to provide ground truth, fixed the model to use that ground truth, and then the fixed model found real game bugs.</p>
<p>The key insight here is that we don’t need perfect oracles. Instead, we need a behavior model composed of one or more properties that catch real bugs and a process that refines both the model and the game through their disagreements. Resolving these disagreements is enormously helped by deterministic execution, which makes this approach practical: we can replay failures as many times as we need, analyze them, fix what’s wrong, and verify the fix—most of the time using the same saved failed path.</p>
<p>The Level 4 teleport bug also revealed something important: the game’s collision resolution logic is not advanced enough to handle complex corner cases where Mario would be jammed between multiple solid objects or enemies. This means the model would still find these cases given enough run time.</p>
<p>Overall, autonomous exploration is excellent at traversing vast state spaces while behavior models ensure correctness throughout. Together, they find not just winning paths, but correctness bugs hiding in edge cases that most likely only your customers would find in production.</p>

        </div>
        <div class="col-12 divider"></div>
        <div class="post-footer"></div>

        <!-- Read Next Carousel Section -->
        
            <div id="readNextCarousel" class="carousel slide col-12" data-ride="carousel" data-interval="5000">
                <div class="carousel-inner">
                    
                        <div class="carousel-item active">
                            <div class="row">
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/testing-super-mario-using-a-behavior-model-autonomously-part1/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/testing-super-mario-using-a-behavior-model-autonomously-part1.png" class="card-img-top" alt="Testing Super Mario Using a Behavior Model Autonomously (Part 1)">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Testing Super Mario Using a Behavior Model Autonomously (Part 1)</h3>
                                            <p class="card-text flex-grow-1">
                                                Autonomous testing is one of the most powerful approaches for exploring vast state spaces in complex...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/testing-super-mario-using-a-behavior-model-part1/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/testing-super-mario-using-a-behavior-model-part1.png" class="card-img-top" alt="Testing Super Mario Using a Behavior Model (Part 1)">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Testing Super Mario Using a Behavior Model (Part 1)</h3>
                                            <p class="card-text flex-grow-1">
                                                The classic game Super Mario isn’t just fun to play—it has also become a favorite system for testing...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                            </div>
                        </div>
                    
                        <div class="carousel-item ">
                            <div class="row">
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/testing-super-mario-using-a-behavior-model-part2/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/testing-super-mario-using-a-behavior-model-part2.png" class="card-img-top" alt="Testing Super Mario Using a Behavior Model (Part 2)">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Testing Super Mario Using a Behavior Model (Part 2)</h3>
                                            <p class="card-text flex-grow-1">
                                                When testing complex stateful systems like Super Mario, behavior models can be your secret weapon. T...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/writing-test-programs-not-just-tests/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/writing-test-programs-not-just-tests.png" class="card-img-top" alt="Writing Test Programs — Not Just Tests">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Writing Test Programs — Not Just Tests</h3>
                                            <p class="card-text flex-grow-1">
                                                Have you ever found yourself fighting your test framework? Wasting hours searching for the right plu...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                            </div>
                        </div>
                    
                        <div class="carousel-item ">
                            <div class="row">
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/stop-bashing-bugs-its-all-your-fault/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/stop-bashing-bugs-its-all-your-fault.png" class="card-img-top" alt="Stop Bashing Bugs – It&#39;s All Your Fault!">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Stop Bashing Bugs – It&#39;s All Your Fault!</h3>
                                            <p class="card-text flex-grow-1">
                                                You’re running your tests, and there it is again — a red light, a failing check, you’ve found anothe...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/what-do-condition-proposition-predicate-property-and-invariant-really-mean/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/what-do-condition-proposition-predicate-property-invariant-really-mean.png" class="card-img-top" alt="What Do Condition, Proposition, Predicate, Property, and Invariant Really Mean?">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">What Do Condition, Proposition, Predicate, Property, and Invariant Really Mean?</h3>
                                            <p class="card-text flex-grow-1">
                                                In software testing, you often hear terms like “condition,” “proposition,” “predicate,” “property,” ...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                            </div>
                        </div>
                    
                        <div class="carousel-item ">
                            <div class="row">
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/transforming-testing-behavior-models-into-formal-models/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/transforming-testing-behavior-models-into-formal-models.png" class="card-img-top" alt="Transforming Testing Behavior Models into Formal Models">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Transforming Testing Behavior Models into Formal Models</h3>
                                            <p class="card-text flex-grow-1">
                                                Most software systems do not come with formal models. However, formal models are invaluable for cons...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/testing-simple-train-control-system-using-formal-description/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/testing-simple-train-control-system-using-formal-description.png" class="card-img-top" alt="Testing Simple Train Control System Using Its Formal Description">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Testing Simple Train Control System Using Its Formal Description</h3>
                                            <p class="card-text flex-grow-1">
                                                In our previous post, Decoding Formal Description of a Simple Train Control System, we examined how ...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                            </div>
                        </div>
                    
                        <div class="carousel-item ">
                            <div class="row">
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/decoding-formal-description-simple-train-control-system/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/decoding-formal-description-simple-train-control-system.png" class="card-img-top" alt="Decoding Formal Description of a Simple Train Control System">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Decoding Formal Description of a Simple Train Control System</h3>
                                            <p class="card-text flex-grow-1">
                                                In scientific research on software testing, you often come across papers filled with complex mathema...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/using-atomic-propositions-and-equivalence-classes-part1/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/using-atomic-propositions-and-equivalence-classes-part1.png" class="card-img-top" alt="Using Atomic Propositions and Equivalence Classes (Part 1)">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Using Atomic Propositions and Equivalence Classes (Part 1)</h3>
                                            <p class="card-text flex-grow-1">
                                                Atomic propositions and equivalence classes offer a practical solution for making testing manageable...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                            </div>
                        </div>
                    
                        <div class="carousel-item ">
                            <div class="row">
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/using-atomic-propositions-and-equivalence-classes-part2/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/using-atomic-propositions-and-equivalence-classes-part2.png" class="card-img-top" alt="Using Atomic Propositions and Equivalence Classes (Part 2)">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Using Atomic Propositions and Equivalence Classes (Part 2)</h3>
                                            <p class="card-text flex-grow-1">
                                                Building on the foundations from Part 1 🛸, where we introduced atomic propositions and equivalence ...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/combinatorial-testing-behavior-model/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/combinatorial-tests-writing-behavior-model.png" class="card-img-top" alt="Combinatorial Testing: Writing Behavior Model">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Combinatorial Testing: Writing Behavior Model</h3>
                                            <p class="card-text flex-grow-1">
                                                Combinatorial testing significantly increases the test coverage of software systems, achieving level...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                            </div>
                        </div>
                    
                        <div class="carousel-item ">
                            <div class="row">
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/sketching-combinations-for-combinatorial-tests/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/sketching-combinations.png" class="card-img-top" alt="Sketching Combinations For Combinatorial Tests">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Sketching Combinations For Combinatorial Tests</h3>
                                            <p class="card-text flex-grow-1">
                                                Writing combinatorial tests usually requires that the author of the test plans for combinatorial tes...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/combinatorial-testing-the-introduction/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/combinatorial-tests-intro.png" class="card-img-top" alt="Combinatorial Testing: The Introduction">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Combinatorial Testing: The Introduction</h3>
                                            <p class="card-text flex-grow-1">
                                                According to the US National Institute of Standards and Technology’s (NIST) page on Combinatorial Te...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                            </div>
                        </div>
                    
                        <div class="carousel-item ">
                            <div class="row">
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/bdd-or-not-to-bdd-or-maybe-tdd-or-even-atdd/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/bdd-or-not-to-bdd.png" class="card-img-top" alt="BDD or not to BDD, or TDD, or even ATDD. How does it affect your QA team?">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">BDD or not to BDD, or TDD, or even ATDD. How does it affect your QA team?</h3>
                                            <p class="card-text flex-grow-1">
                                                How do software development processes such as behavior-driven development (BDD), test-driven develop...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/get-your-software-covered-using-covering-arrays/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/covering-arrays.png" class="card-img-top" alt="Get Your Software Covered Using Covering Arrays">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Get Your Software Covered Using Covering Arrays</h3>
                                            <p class="card-text flex-grow-1">
                                                For software systems with any non-trivial number of parameters, exhaustively testing all possible co...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                            </div>
                        </div>
                    
                        <div class="carousel-item ">
                            <div class="row">
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/working-with-requirements-just-like-with-code/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/requirements-as-code.png" class="card-img-top" alt="Working With Requirements Just Like With Code">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Working With Requirements Just Like With Code</h3>
                                            <p class="card-text flex-grow-1">
                                                “Requirements are the starting point of any design”, this is a quote from the presentation given by ...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                                <div class="col-md-6 d-flex">
                                    <a href="/blog/how-to-break-your-tests-into-steps/" class="card shadow-sm d-flex flex-column text-decoration-none text-dark">
                                        <img src="/images/test-steps.png" class="card-img-top" alt="Making Your Tests Better or How to Break Your Tests Into Steps">
                                        <div class="card-body d-flex flex-column">
                                            <h3 class="card-title">Making Your Tests Better or How to Break Your Tests Into Steps</h3>
                                            <p class="card-text flex-grow-1">
                                                Writing tests is not as easy task as it may seem at first glance.
In many cases, writing a good test...
                                            </p>
                                        </div>
                                    </a>                                     
                                </div>
                                
                            </div>
                        </div>
                    
                </div>
                <!-- Carousel Controls -->
                <a class="carousel-control-prev" href="#readNextCarousel" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#readNextCarousel" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        
        <!-- End of Read Next Carousel -->
    </div>
</div>
<script>
    window.addEventListener("load", function(){
        // add support to make headers to be clickable
        document.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(function(element){
            element.addEventListener("click", function(event){
                element_id = element.getAttribute("id");
                if (element_id) {
                    window.location = "#" + element_id;
                }
            }, true);
        });
    });

    document.addEventListener("DOMContentLoaded", function () {
        var carousel = document.getElementById("readNextCarousel");
        var touchStartX = 0;
        var touchEndX = 0;

        function handleSwipe() {
            if (touchEndX < touchStartX - 50) {
                // Swipe left → Move to next slide
                var nextBtn = document.querySelector("#readNextCarousel .carousel-control-next");
                if (nextBtn) nextBtn.click();
            } else if (touchEndX > touchStartX + 50) {
                // Swipe right → Move to previous slide
                var prevBtn = document.querySelector("#readNextCarousel .carousel-control-prev");
                if (prevBtn) prevBtn.click();
            }
        }

        carousel.addEventListener("touchstart", function (event) {
            touchStartX = event.changedTouches[0].screenX;
        });

        carousel.addEventListener("touchend", function (event) {
            touchEndX = event.changedTouches[0].screenX;
            handleSwipe();
        });
    });
</script>

    </div>
  </div>
  <div class="container-footer" id="container-footer">
    
    <footer> <div class="row no-gutters">
    <div class="col-12 text-center">
        <div class="links">
            <div class="btn-group" role="group" aria-label="Basic example">
                <button type="button" class="btn btn-secondary">
                    <a target="_blank" rel="noopener external nofollow noreferrer" href="https://pypi.org/project/testflows/">
                        <span class="fab fa-2x fa-python"></span>
                    </a>
                </button>
                <button type="button" class="btn btn-secondary">
                    <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.linkedin.com/company/testflows-com-open-source-testing-framework/">
                        <span class="fab fa-3x fa-linkedin"></span>
                    </a>
                </button>
                <button type="button" class="btn btn-secondary">
                    <a target="_blank" rel="noopener external nofollow noreferrer" href="https://x.com/TestFlowsOSTF">
                        <span class="fab fa-3x fa-x-twitter"></span>
                    </a>
                </button>
                <button type="button" class="btn btn-secondary">
                    <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/testflows">
                        <span class="fab fa-2x fa-github"></span>
                    </a>
                </button>
            </div>
        </div>
    </div>
    <div class="col-12 text-center">
        <img src="/img/favicon-square.png"</img>
    </div>
    <div class="col-12 text-center">
        Copyright 2020-2025 Katteli Inc.
    </div>
    <div class="col-12 text-center">
        <span class="text-nowrap">All rights reserved.</span>
    </div>
    <div class="col-12 text-center no-padding links">
        <a class="btn" href="/credits.html">Credits</a>
    </div>
</div>
 </footer>
    
  </div>
  <script src="/js/jquery-3.4.1.slim.js"></script>
<script src="/js/popper.min.js"></script>
<script src="/js/bootstrap/bootstrap.min.js"></script>
<script src="https://unpkg.com/3d-force-graph@1.72.3/dist/3d-force-graph.min.js"></script>
<script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "ab95920418b1480e9f8458e94fe40615"}'></script>
<script>
var isInViewport = function (elem) {
    var bounding = elem.getBoundingClientRect();
    return (
        bounding.top >= 0 &&
        bounding.left >= 0 &&
        bounding.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
        bounding.right <= (window.innerWidth || document.documentElement.clientWidth)
    );
};
var banner = document.querySelector('.banner');
window.addEventListener('scroll', function (event) {
	if (isInViewport(banner)) {
    	banner.classList.remove("not-in-view");
	} else {
	    banner.classList.add("not-in-view");
	}
}, false);
// codeblock copy
function codeblock_copy() {
    $("figure.highlight").hover(
        function() {
            var figure = $(this);
            $( this ).append($("<button class=\"btn codeblock-copy\"><i class=\"fas fa-clipboard\"></i></button>"));
        }, function() {
            $( this ).find("button").first().remove();
        }
    );
    $("figure.highlight").click(
        function() {
            var figure = $(this);
            navigator.clipboard.writeText(figure.find(".code").first()[0].innerText.trimEnd()).then(
                function() {
                    figure.find(".codeblock-copy").find("i").removeClass("fa-clipboard").addClass("fa-clipboard-check");
                }
            )
        }
    );
}
// apply codeblock copy
codeblock_copy()
// hero graph
function heroGraph() {
    const distance = 2350;
    const N = 7;
    const msb = n => Math.max(0, 31 - Math.clz32(n));
    const gData = {
        nodes: [...Array(2**(N+1)-2).keys()].map(i => ({ id: i, group: i % 2, val: msb(i) })),
        links: [...Array(2*((2**(N+1)-2)-2**N)).keys()]
        .map(id => ({
            source: Math.floor(id/2),
            target: id+2
        }))
    };
    start = gData.nodes.length;
    gData.nodes.push({id:start, group: 2, val:msb(start)});
    gData.links.push({source: start, target: 0});
    gData.links.push({source: start, target: 1});
    window.Graph = ForceGraph3D()
    .backgroundColor("black")
    //.dagMode('td')
    //.dagLevelDistance(200)
    (document.getElementById('banner-graph'))
	.nodeAutoColorBy('group')
    .linkAutoColorBy(d => gData.nodes[d.source].group)
	.onNodeDragEnd(node => {
        node.fx = node.x;
        node.fy = node.y;
        node.fz = node.z;
    })
    .linkDirectionalArrowLength(3.5)
    .linkDirectionalArrowRelPos(1)
    .graphData(gData);
    // camera orbit
    let angle = 0;
    //let isRotationActive = true;
    window.Graph.cameraPosition({
        x: distance * Math.sin(angle),
        z: distance * Math.cos(angle)
    });
    window.Graph.dagGraphModes = ['td', 'bu', 'lr', 'rl', 'zin', 'zout', 'radialout', 'radialin', 'off'];
    window.Graph.currentDagMode = 0;
}
// disabling form submissions if there are invalid fields
(function() {
    'use strict';
    window.addEventListener('load', function() {
      // Fetch all the forms we want to apply custom Bootstrap validation styles to
      var forms = document.getElementsByClassName('needs-validation');
      // Loop over them and prevent submission
      var validation = Array.prototype.filter.call(forms, function(form) {
        form.addEventListener('submit', function(event) {
          if (form.checkValidity() === false) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add('was-validated');
        }, false);
      });
    }, false);
  })();
</script>

</body>
</html>


